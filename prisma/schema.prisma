// Este é o arquivo de esquema Prisma,
// saiba mais sobre ele na documentação: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

// Modelo de Usuário
model User {
  id        Int      @id @default(autoincrement()) // ID único do usuário
  userName  String // Nome de usuário
  email     String // Email do usuário
  password  String // Senha do usuário
  avatarUrl String? // URL do avatar do usuário
  active    Boolean // Indica se o usuário está ativo
  role      String   @default("Usuário Padrão") // Define o valor padrão como "Usuário Padrão"
  work      Work[] // Relacionamento com obras associadas ao usuário
  createdAt DateTime @default(now()) // Data e hora de criação
  updatedAt DateTime @default(now()) // Data e hora de atualização
}

// Modelo de Obra
model Work {
  id              Int            @id @default(autoincrement()) // ID único da obra
  workDescription String // Descrição da obra
  company         String // Nome da empresa da obra
  nameResponsible String // Nome da pessoa responsável pela obra
  phoneContact    String // Número de contato da obra
  address         String // Endereço completo da obra
  logoUrl         String? // Logotipo da obra
  active          Boolean // Indica se a obra está ativa
  createdAt       DateTime       @default(now()) // Data e hora de criação
  updatedAt       DateTime       @default(now()) // Data e hora de atualização
  user            User           @relation(fields: [userId], references: [id]) // Relacionamento com o usuário
  userId          Int
  services        Service[] // Relacionamento com serviços associados à obra
  Team            Team[] //// Relacionamento com as equipes da obra
  Shift           Shift[] //Relacionamento com os turnos da obra
  Interference    Interference[] //Relacionamento com as interferências da obra
  Location        Location[] // Relacionamento com os locais da obra
  Effective       Effective[] // Relacionamento com os efetivos da obra
}

// Modelo de Serviço
model Service {
  id                 Int                @id @default(autoincrement()) // ID único do serviço
  workId             Int // ID da obra associada ao serviço
  work               Work               @relation(fields: [workId], references: [id]) // Relacionamento com a obra
  serviceDescription String // Descrição do serviço
  unit               String // Unidade de medida do serviço
  status             String // Status do serviço
  subcategoryId      Int // ID da subcategoria do serviço
  subcategory        SubServiceCategory @relation(fields: [subcategoryId], references: [id]) // Relacionamento com a subcategoria do serviço
  createdAt          DateTime           @default(now()) // Data e hora de criação
  updatedAt          DateTime           @default(now()) // Data e hora de atualização
}

// Modelo de Categoria de Serviço
model ServiceCategory {
  id            Int                  @id @default(autoincrement()) // ID único da categoria de serviço
  name          String // Nome da categoria de serviço
  status        String // Status da categoria de serviço
  subcategories SubServiceCategory[] // Relacionamento com subcategorias de serviço
  createdAt     DateTime             @default(now()) // Data e hora de criação
  updatedAt     DateTime             @default(now()) // Data e hora de atualização
}

// Modelo de Subcategoria de Serviço
model SubServiceCategory {
  id                Int             @id @default(autoincrement()) // ID único da subcategoria de serviço
  name              String // Nome da subcategoria de serviço
  status            String // Status da subcategoria de serviço
  serviceCategoryId Int // ID da categoria de serviço à qual a subcategoria pertence
  serviceCategory   ServiceCategory @relation(fields: [serviceCategoryId], references: [id]) // Relacionamento com a categoria de serviço
  services          Service[] // Relacionamento com serviços associados à subcategoria
}

// Modelo de Equipe
model Team {
  id                Int            @id @default(autoincrement()) // ID único da equipe
  workId            Int // ID da obra à qual a equipe está associada
  work              Work           @relation(fields: [workId], references: [id]) // Relacionamento com a obra
  descricaoEquipe   String // Descrição da equipe
  empresaContratada String // Nome da empresa contratada para a equipe
  status            String // Status da Equipe
  Shifts            Shift[] // Relacionamento com os turnos da equipe
  Interferences     Interference[] // Relacionamento com as interferências da equipe
  createdAt         DateTime       @default(now()) // Data e hora de criação
  updatedAt         DateTime       @default(now()) // Data e hora de atualização
}

// Modelo de Turno
model Shift {
  id               Int      @id @default(autoincrement()) // ID único do turno
  teamId           Int // ID da equipe à qual o turno está associado
  team             Team     @relation(fields: [teamId], references: [id]) // Relacionamento com a equipe
  workId           Int // ID da obra à qual o turno está associado
  work             Work     @relation(fields: [workId], references: [id]) // Relacionamento com a obra
  description      String // Descrição do turno
  feasibility      String // Praticabilidade do turno
  weatherCondition String // Condições climáticas do turno
  status           String // Status da Interferência
  createdAt        DateTime @default(now()) // Data e hora de criação
  updatedAt        DateTime @default(now()) // Data e hora de atualização
}

// Modelo de Interferência
model Interference {
  id                      Int      @id @default(autoincrement()) // ID único da interferência
  teamId                  Int // ID da equipe à qual a interferência está associada
  team                    Team     @relation(fields: [teamId], references: [id]) // Relacionamento com a equipe
  workId                  Int // ID da obra à qual a interferência está associada
  work                    Work     @relation(fields: [workId], references: [id]) // Relacionamento com a obra
  interferenceResponsible String // Responsável pela interferência
  category                String // Categoria da interferência
  subCategory             String // Subcategoria da interferência
  status                  String // Status da Interferência
  createdAt               DateTime @default(now()) // Data e hora de criação
  updatedAt               DateTime @default(now()) // Data e hora de atualização
}

// Modelo de Local
model Location {
  id                  Int      @id @default(autoincrement()) // ID único do local
  workId              Int // ID da obra à qual o local está associado
  work                Work     @relation(fields: [workId], references: [id]) // Relacionamento com a obra
  descriptionLocation String // Descrição do local
  responsibleLocation String // Responsável pelo local
  status              String // Status da Interferência
  createdAt           DateTime @default(now()) // Data e hora de criação
  updatedAt           DateTime @default(now()) // Data e hora de atualização
}

// Modelo de Efetivo
model Effective {
  id                   Int      @id @default(autoincrement()) // ID único do efetivo
  workId               Int // ID da obra à qual o efetivo está associado
  work                 Work     @relation(fields: [workId], references: [id]) // Relacionamento com a obra
  type                 String // Tipo de efetivo
  descriptionEffective String // Descrição do efetivo
  status               String // Status da Interferência
  createdAt            DateTime @default(now()) // Data e hora de criação
  updatedAt            DateTime @default(now()) // Data e hora de atualização
}
